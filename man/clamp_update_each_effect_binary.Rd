% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/clamp_update_each_effect_binary.R
\name{clamp_update_each_effect_binary}
\alias{clamp_update_each_effect_binary}
\title{Update each effect once in a linear model; each sub-model is a
IPW-SER.}
\usage{
clamp_update_each_effect_binary(
  X,
  y,
  s,
  W = NULL,
  mle_estimator = c("mHT", "WLS"),
  mle_variance_estimator = c("bootstrap", "sandwich"),
  nboots = 100,
  seed = NULL,
  estimate_prior_variance = FALSE,
  estimate_prior_method = "optim",
  check_null_threshold = 0,
  abnormal_proportion = 0.5,
  robust_method = c("none", "huber"),
  robust_estimator = c("M", "S")
)
}
\arguments{
\item{X}{An (n by p) matrix of regressor variables}

\item{y}{An n vector of response variable}

\item{s}{A clamp fit}

\item{W}{An (n by p) matrix of weights. If \code{W=NULL}, it reduces to an
SER}

\item{mle_estimator}{The estimation method of the ATE estimator.
\code{"mHT"} applies the modified Horvitz-Thompson estimator, and
\code{"WLS"} applies the equivalent weighted least-squares estimator.}

\item{mle_variance_estimator}{The estimation method of the variance of the
MLEs, or equivalently, the variance of (Horvitz-Thompson) ATE estimators.
\code{"bootstrap"} estimates the variances from \code{nboots} bootstrap
replicates,
\code{"sandwich"} uses sandwich robust variance estimators.
\code{"naive"} calculates the variances from the weighted least square model,
treating weights as constants (not recommended).}

\item{nboots}{The number of bootstrap replicates. By default,
\code{nboots=100}.}

\item{seed}{Random seed utilized when
\code{mle_variance_estimator="bootstrap"}.
If \code{seed=NULL}, its default is \code{Sys.time()}.}

\item{estimate_prior_variance}{boolean indicating whether to
estimate prior variance}

\item{check_null_threshold}{Float, a threshold on the log scale to
compare likelihood between current estimate and zero the null}

\item{abnormal_proportion}{a value between 0 and 1. If the number of detected
abnormal subjects exceeds \code{abnormal_proportion * nrow(X)},
stop fitting the model.}

\item{robust_method}{A string, whether and which robust method is applied
when fitting the model. \code{robust_method="none"} specifies that no
robust method is applied. \code{robust_method="huber"} specifies that the
Huber weighting method is applied.}

\item{robust_estimator}{A string, which robust estimator is applied.
\code{robust_estimator="M"} indicates the M-estimator is applied, and
\code{robust_estimator="S"} indicates the S-estimator is applied.}

\item{standardize}{logical. If \code{standardize=TRUE}, then each column of
. X will be standardized by its corresponding weighted sd.}
}
\description{
Update each effect once in a linear model; each sub-model is a
IPW-SER.
}
