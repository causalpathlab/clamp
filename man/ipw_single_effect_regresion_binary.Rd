% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ipw_single_effect_regression_binary.R
\name{ipw_single_effect_regression_binary}
\alias{ipw_single_effect_regression_binary}
\title{Single effect regression with inverse probability weighting estimates for binary treatments}
\usage{
ipw_single_effect_regression_binary(
  y,
  X,
  W = NULL,
  prior_varD,
  residual_variance = 1,
  prior_inclusion_prob = NULL,
  optimize_prior_varD = c("none", "optim", "EM", "simple"),
  check_null_threshold = 0,
  mle_estimator = c("mHT", "WLS"),
  mle_variance_estimator = c("bootstrap", "sandwich"),
  nboots = 100,
  seed = NULL
)
}
\arguments{
\item{y}{An (n by 1) vector of responses.}

\item{X}{An (n by p) data matrix; each entry would be 0 or 1.}

\item{W}{An (n by p) matrix; each entry is the weight of each each
entry of \eqn{X}; it should be of the same size as \eqn{X}.}

\item{prior_varD}{A scalar given the (initial) prior variance of the coefficient.}

\item{residual_variance}{A scalar refers to the residual variance.
To be consistent with susieR, it should be specified when \code{W=NULL}.}

\item{optimize_prior_varD}{The optimization method to use for fitting the prior
variance.}

\item{check_null_threshold}{Scalar specifying the threshold on the log-scale
to compare likelihood between current estimate and zero (null).}

\item{mle_estimator}{The estimation method of the MLEs of the ATEs.
\code{"ipw"} estimates the ATE with inverse probability weighting estimator,
and \code{"wls"} applies the equivalent weighted least-squares estimator.
The estimates from these two values should be the same if the input X is not
centralized and standardized.}

\item{mle_variance_estimator}{The estimation method of the variance of the MLEs,
or equivalently, the variance of (Horvitz-Thompson) ATE estimators.
\code{"bootstrap"} estimates the variances from \code{nboots} bootstrap replicates,
\code{"sandwich"} uses sandwich robust variance estimators.
\code{"naive"} calculates the variances from the weighted least square model,
treating weights as constants (not recommended).}

\item{nboots}{The number of bootstrap replicates. By default, \code{nboots=100}.}

\item{seed}{Random seed utilized when \code{mle_variance_estimator="bootstrap"}.
If \code{seed=NULL}, its default is \code{Sys.time()}.}

\item{prior_inclusions_prob}{An (p by 1) vector of prior inclusion
probabilities.}
}
\value{
A list with the following elements:

\item{alpha}{Vector of posterior inclusion probabilities;
\code{alpha[i]} is posterior probability that the ith
coefficient is non-zero.}

\item{mu}{Vector of posterior means (conditional on inclusion).}

\item{mu2}{Vector of posterior second moments (conditional on inclusion).}

\item{logBF}{Vector of log of (asymptotic) Bayes factor for each variable.}

\item{logBF_model}{Log of (asymptotic) Bayes factor for the
weighted single effect regression.}

\item{prior_varD}{Prior variance (after optimization if \code{optimize_prior_varD != "none"}).}
}
\description{
This function is to compute the posterior distribution of the regression
coefficients of a IPW-SER model. Adapted from:
\url{https://github.com/stephenslab/susieR/blob/master/R/single_effect_regression.R}
This is basically for function \code{clamp}.
}
\keyword{internal}
